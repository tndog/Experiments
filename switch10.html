<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Switch 10 - Logic Puzzle</title>
    <style>
        :root {
            --wood: #5d4037;
            --hole-bg: #222;
            --green-peg: radial-gradient(circle at 30% 30%, #81c784, #2e7d32);
            --yellow-peg: radial-gradient(circle at 30% 30%, #fff176, #fbc02d);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #e0e0e0;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        /* Modal Styles */
        #modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .modal {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 450px;
            text-align: left;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .modal h2 { margin-top: 0; color: #3e2723; }
        .modal ul { padding-left: 20px; line-height: 1.6; }
        .modal-btn { width: 100%; margin-top: 20px; }

        /* Game Elements */
        .stats { margin: 10px 0; font-size: 1.2rem; display: flex; gap: 40px; font-weight: bold; }
        
        #game-board {
            display: flex; gap: 8px; padding: 25px;
            background: var(--wood);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            border: 4px solid #3e2723;
            margin: 20px 0;
        }

        .hole {
            width: 55px; height: 55px; border-radius: 50%;
            background: var(--hole-bg);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: inset 0 4px 6px rgba(0,0,0,0.5);
        }

        .peg {
            width: 45px; height: 45px; border-radius: 50%;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 2;
        }

        .green { background: var(--green-peg); box-shadow: 0 4px #1b5e20; }
        .yellow { background: var(--yellow-peg); box-shadow: 0 4px #f57f17; }

        .controls { display: flex; gap: 15px; }

        button {
            padding: 12px 24px; font-size: 1rem; border: none;
            border-radius: 8px; cursor: pointer;
            background: #3e2723; color: white;
            transition: 0.2s; box-shadow: 0 4px #221512;
        }

        button:hover { background: #5d4037; transform: translateY(-1px); }
        button:active { transform: translateY(2px); box-shadow: 0 0; }
        button:disabled { background: #999; box-shadow: none; cursor: not-allowed; }

        #status { margin-top: 20px; font-weight: bold; font-size: 1.1rem; min-height: 1.5em; }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        .winner { animation: bounce 0.5s ease infinite; }
    </style>
</head>
<body>

    <div id="modal-overlay">
        <div class="modal">
            <h2>How to Play Switch 10</h2>
            <p>The goal is to move all <strong>Green</strong> pegs to the right and all <strong>Yellow</strong> pegs to the left.</p>
            <ul>
                <li><strong>Forward Only:</strong> Pegs cannot move backward.</li>
                <li><strong>Step:</strong> Move into an adjacent empty hole.</li>
                <li><strong>Jump:</strong> Jump over <em>one</em> opposing peg into an empty hole.</li>
            </ul>
            <button class="modal-btn" onclick="closeModal()">Start Game</button>
        </div>
    </div>

    <h1>Switch 10</h1>
    
    <div class="stats">
        <div>Moves: <span id="move-count">0</span></div>
        <div>Best: <span id="best-score">-</span></div>
    </div>

    <div id="game-board"></div>
    <div id="status"></div>

    <div class="controls">
        <button id="undo-btn" onclick="undoMove()">Undo</button>
        <button onclick="resetGame()">Reset</button>
        <button onclick="showModal()">Help</button>
    </div>

    <script>
        let board = ['G', 'G', 'G', 'G', 'G', 'E', 'Y', 'Y', 'Y', 'Y', 'Y'];
        let history = [];
        let moves = 0;
        let gameActive = true;

        const boardEl = document.getElementById('game-board');
        const statusEl = document.getElementById('status');
        const moveEl = document.getElementById('move-count');
        const bestEl = document.getElementById('best-score');
        const undoBtn = document.getElementById('undo-btn');
        const modal = document.getElementById('modal-overlay');

        function showModal() { modal.style.display = 'flex'; }
        function closeModal() { modal.style.display = 'none'; }

        function render() {
            boardEl.innerHTML = '';
            moveEl.innerText = moves;
            const savedBest = localStorage.getItem('switch10_best');
            bestEl.innerText = savedBest ? savedBest : '-';
            undoBtn.disabled = history.length === 0 || !gameActive;

            board.forEach((cell, index) => {
                const hole = document.createElement('div');
                hole.className = 'hole';
                if (cell !== 'E') {
                    const peg = document.createElement('div');
                    peg.className = `peg ${cell === 'G' ? 'green' : 'yellow'}`;
                    hole.appendChild(peg);
                    if (gameActive) hole.onclick = () => tryMove(index);
                }
                boardEl.appendChild(hole);
            });

            if (gameActive && !checkWin() && !canAnyoneMove()) {
                statusEl.innerText = "Stalemate! No more legal moves.";
                statusEl.style.color = "#d32f2f";
            }
        }

        function tryMove(idx) {
            const type = board[idx];
            const dir = type === 'G' ? 1 : -1;
            let targetIdx = null;

            if (board[idx + dir] === 'E') targetIdx = idx + dir;
            else if (board[idx + (dir * 2)] === 'E') targetIdx = idx + (dir * 2);

            if (targetIdx !== null) {
                history.push([...board]);
                moves++;
                const temp = board[idx];
                board[idx] = board[targetIdx];
                board[targetIdx] = temp;
                statusEl.innerText = "";
                render();
            }
        }

        function canAnyoneMove() {
            return board.some((cell, idx) => {
                if (cell === 'E') return false;
                const dir = cell === 'G' ? 1 : -1;
                return (board[idx + dir] === 'E' || board[idx + (dir * 2)] === 'E');
            });
        }

        function undoMove() {
            if (history.length > 0) {
                board = history.pop();
                moves--;
                statusEl.innerText = "";
                gameActive = true;
                render();
            }
        }

        function checkWin() {
            const isWin = board.join('') === 'YYYYYEGGGGG';
            if (isWin) {
                gameActive = false;
                statusEl.innerText = "ðŸŽ‰ Puzzle Solved!";
                statusEl.style.color = "#2e7d32";
                const pegs = document.querySelectorAll('.peg');
                pegs.forEach((peg, index) => {
                    setTimeout(() => peg.classList.add('winner'), index * 80);
                });
                const currentBest = localStorage.getItem('switch10_best');
                if (!currentBest || moves < parseInt(currentBest)) {
                    localStorage.setItem('switch10_best', moves);
                }
                return true;
            }
            return false;
        }

        function resetGame() {
            board = ['G', 'G', 'G', 'G', 'G', 'E', 'Y', 'Y', 'Y', 'Y', 'Y'];
            history = []; moves = 0; gameActive = true;
            statusEl.innerText = "";
            render();
        }

        render();
    </script>
</body>
</html>
